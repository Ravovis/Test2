import './polyfills.server.mjs';
import{b as h}from"./chunk-SPRODXD5.mjs";import{b as n,h as u,k as o}from"./chunk-3LKYKCQ5.mjs";import{a as r}from"./chunk-VVCT4QZE.mjs";var g=(()=>{class i{constructor(s){this.taskService=s,this.users=[],this.usersSubject=new n(this.users),this.users$=this.usersSubject.asObservable(),this.initializeSampleData(),this.updateAssignedTasksCount()}initializeSampleData(){let s=[{id:"1",name:"John Developer",email:"john@company.com",role:"Developer",assignedTasksCount:0},{id:"2",name:"Sarah Designer",email:"sarah@company.com",role:"Designer",assignedTasksCount:0},{id:"3",name:"Mike QA",email:"mike@company.com",role:"QA",assignedTasksCount:0},{id:"4",name:"Lisa Manager",email:"lisa@company.com",role:"Manager",assignedTasksCount:0}];this.users=s,this.usersSubject.next(this.users)}getAllUsers(){return this.users$}getUserById(s){return this.users.find(e=>e.id===s)}createUser(s){let e={id:this.generateId(),name:s.name,email:s.email,role:s.role,assignedTasksCount:0};return this.users.push(e),this.usersSubject.next(this.users),e}updateUser(s,e){let t=this.users.findIndex(a=>a.id===s);return t===-1?null:(this.users[t]=r(r({},this.users[t]),e),this.usersSubject.next(this.users),this.users[t])}deleteUser(s){this.taskService.getAllTasks().subscribe(t=>{if(t.some(c=>c.assigneeId===s))throw new Error("Cannot delete user with assigned tasks")});let e=this.users.findIndex(t=>t.id===s);return e===-1?!1:(this.users.splice(e,1),this.usersSubject.next(this.users),!0)}updateAssignedTasksCount(){this.taskService.getAllTasks().subscribe(s=>{this.users.forEach(e=>{e.assignedTasksCount=s.filter(t=>t.assigneeId===e.id).length}),this.usersSubject.next(this.users)})}generateId(){return Date.now().toString()+Math.random().toString(36).substr(2,9)}static{this.\u0275fac=function(e){return new(e||i)(o(h))}}static{this.\u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();export{g as a};
